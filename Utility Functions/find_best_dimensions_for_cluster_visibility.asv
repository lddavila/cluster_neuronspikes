function [min_b_dist_among_highest_mean_b_dist,which_dim_were_best] = find_best_dimensions_for_cluster_visibility(all_peaks,cluster_idx,current_cluster)

list_of_all_dimensions = 1:size(all_peaks,2);
mean_bhat_of_varying_number_of_dimensions = [];
bhat_distances_for_varying_number_of_dimensions = {};
the_various_dimensions = {};
for k = 1:size(all_peaks,2)
    all_comb_for_k_dimensions = nchoosek(list_of_all_dimensions,k);
    bhat_distances_for_current_dim = [];
    for current_combination = 1:size(all_comb_for_k_dimensions,1)
        the_various_dimensions{end+1} = all_comb_for_k_dimensions(current_combination,:);
        curr_clust_in_curr_dim_comb = all_peaks(cluster_idx{current_cluster},all_comb_for_k_dimensions(current_combination,:));
        for cluster_counter=1:length(cluster_idx)
            if cluster_counter==current_cluster
                continue
            end
            comp_clust_in_curr_dim_comb = all_peaks(cluster_idx{cluster_counter},all_comb_for_k_dimensions(current_combination,:));
            bhat_dist_from_current_clust_to_comp_clust = bhattacharyyaDistance([curr_clust_in_curr_dim_comb;comp_clust_in_curr_dim_comb],[zeros(size(curr_clust_in_curr_dim_comb,1),1)+1;zeros(comp_clust_in_curr_dim_comb,1)]);

            bhat_distances_for_current_dim = [bhat_distances_for_current_dim;bhat_dist_from_current_clust_to_comp_clust];
            
        end
        mean_of_b_dist_for_curr_dim_comb = mean(bhat_distances_for_current_dim);
        mean_bhat_of_varying_number_of_dimensions = [mean_bhat_of_varying_number_of_dimensions,mean_of_b_dist_for_curr_dim_comb];
        bhat_distances_for_varying_number_of_dimensions{end+1} = bhat_distances_for_current_dim;
    end
end

[~,I] = max(mean_bhat_of_varying_number_of_dimensions);
dimensions_with_highest_bhat_distance = bhat_distances_for_varying_number_of_dimensions{I};
[min_b_dist_among_highest_mean_b_dist,Index_of_min ]= min(dimensions_with_highest_bhat_distance);
which_dim_were_best = 


end